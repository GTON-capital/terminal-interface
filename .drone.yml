kind: pipeline
type: docker
name: terminal-interface

pipeline:
  run-test:
    image: node
    commands:
      - node --version
      - nvm --version
    when:
      event:
        - pull_request
  deployment:
    image: node
    # host: test.cli.gton.capital
    # settings:
    #   username: root
    # key:
    #   from_secret: ssh_key
    # port:
    #   from_secret: ssh_port
    # script:
    # - cd /var/www/terminal-interface && sh ./.drone/deploy.sh
    commands:
      - git clean -fd
      - git reset --hard
      - git pull origin drone-integrate
      - npm i
      - npm run build
      - npm run generate
    when:
      branch:
        - drone-integrate
      event:
        - push

trigger:
  branch:
    - drone-integrate